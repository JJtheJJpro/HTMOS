use core::{cell::Cell, fmt::Write, panic::PanicInfo};

use crate::boot_info::boot_info;

#[panic_handler]
fn panic_handler(_info: &PanicInfo) -> ! {
    fill_screen(0xFF, 0, 0);

    loop {
        unsafe {
            core::arch::asm!("hlt");
        }
    }
}

const ARGB: u32 = 0;
const ABGR: u32 = 1;
//const BIT_MASK: u32 = 2;
//const BLT_ONLY: u32 = 3;
//const FORMAT_MAX: u32 = 4;
pub fn set_pixel(x: u32, y: u32, r: u8, g: u8, b: u8) -> Result<(), &'static str> {
    let bi = boot_info();

    if x > bi.framebuffer_width {
        return Err("x goes beyond width limit");
    } else if y > bi.framebuffer_height {
        return Err("y goes beyond height limit");
    }

    let fb_addr = bi.framebuffer_addr as *mut u32;
    let fb_bpp = bi.framebuffer_bpp;
    let fb_pitch = bi.framebuffer_pitch;

    let offset = y * fb_pitch * fb_bpp + x * fb_bpp;
    let px = unsafe { fb_addr.add(offset as usize) };
    unsafe {
        match fb_bpp {
            // this is assuming the machine is little-endian
            ARGB => {
                px.write_volatile(((r as u32) << 16) | ((g as u32) << 8) | (b as u32));
            }
            ABGR => {
                px.write_volatile(((b as u32) << 16) | ((g as u32) << 8) | (r as u32));
            }
            _ => {
                panic!("unknown fb bpp value of {fb_bpp}");
            }
        }
    }

    Ok(())
}
pub fn fill_screen(r: u8, g: u8, b: u8) {
    let bi = boot_info();

    let fb_addr = bi.framebuffer_addr as *mut u32;
    let fb_bpp = bi.framebuffer_bpp;
    let fb_width = bi.framebuffer_width;
    let fb_height = bi.framebuffer_height;
    let fb_pitch = bi.framebuffer_pitch;

    for y in 0..fb_height {
        for x in 0..fb_width {
            let offset = y * fb_pitch * fb_bpp + x * fb_bpp;
            let px = unsafe { fb_addr.add(offset as usize) };
            unsafe {
                match fb_bpp {
                    // this is assuming the machine is little-endian
                    ARGB => {
                        px.write_volatile(((r as u32) << 16) | ((g as u32) << 8) | (b as u32));
                    }
                    ABGR => {
                        px.write_volatile(((b as u32) << 16) | ((g as u32) << 8) | (r as u32));
                    }
                    _ => {
                        panic!("unknown fb bpp value of {fb_bpp}");
                    }
                }
            }
        }
    }
}

const CONSOLE_ASCII: [[u16; 20]; 0xFF] = {
    let mut r = [[0u16; 20]; 0xFF];
    r[0x00] = [
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
    ];

    r[0x20] = [
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
    ];
    r[0x21] = [
        0b0000000000,
        0b0000000000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000000000,
        0b0000000000,
        0b0000110000,
        0b0000110000,
        0b0000000000,
        0b0000000000,
    ]; // !
    r[0x22] = [
        0b0000000000,
        0b0000000000,
        0b0011001100,
        0b0011001100,
        0b0011001100,
        0b0011001100,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
    ]; // "
    r[0x23] = [
        0b0000000000,
        0b0000000000,
        0b0011001100,
        0b0011001100,
        0b0011001100,
        0b0011001100,
        0b0111111110,
        0b0111111110,
        0b0011001100,
        0b0011001100,
        0b0011001100,
        0b0011001100,
        0b0111111110,
        0b0111111110,
        0b0011001100,
        0b0011001100,
        0b0011001100,
        0b0011001100,
        0b0000000000,
        0b0000000000,
    ]; // #
    r[0x24] = [
        0b0000000000,
        0b0000110000,
        0b0011111100,
        0b0111111110,
        0b0110110110,
        0b0110110000,
        0b0110110000,
        0b0110110000,
        0b0110110000,
        0b0111111100,
        0b0011111110,
        0b0000110110,
        0b0000110110,
        0b0000110110,
        0b0000110110,
        0b0110110110,
        0b0111111110,
        0b0011111100,
        0b0000110000,
        0b0000000000,
    ]; // $
    r[0x25] = [
        0b0000000000,
        0b0000000000,
        0b0011000110,
        0b0111100110,
        0b0111101110,
        0b0011001100,
        0b0000011100,
        0b0000011000,
        0b0000111000,
        0b0000110000,
        0b0000110000,
        0b0001110000,
        0b0001100000,
        0b0011100000,
        0b0011001100,
        0b0111011110,
        0b0110011110,
        0b0110001100,
        0b0000000000,
        0b0000000000,
    ]; // %
    r[0x26] = [
        0b0000000000,
        0b0000000000,
        0b0001111000,
        0b0011111100,
        0b0011001100,
        0b0011001100,
        0b0011001100,
        0b0011111100,
        0b0001111000,
        0b0000110000,
        0b0001110000,
        0b0011110110,
        0b0111111110,
        0b0110011100,
        0b0110001100,
        0b0110011100,
        0b0111111110,
        0b0011110110,
        0b0000000000,
        0b0000000000,
    ]; // &
    r[0x27] = [
        0b0000000000,
        0b0000000000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
    ]; // '
    r[0x28] = [
        0b0000000000,
        0b0000000000,
        0b0000011000,
        0b0000111000,
        0b0001110000,
        0b0001100000,
        0b0001100000,
        0b0001100000,
        0b0001100000,
        0b0001100000,
        0b0001100000,
        0b0001100000,
        0b0001100000,
        0b0001100000,
        0b0001100000,
        0b0001110000,
        0b0000111000,
        0b0000011000,
        0b0000000000,
        0b0000000000,
    ]; // (
    r[0x29] = [
        0b0000000000,
        0b0000000000,
        0b0001100000,
        0b0001110000,
        0b0000111000,
        0b0000011000,
        0b0000011000,
        0b0000011000,
        0b0000011000,
        0b0000011000,
        0b0000011000,
        0b0000011000,
        0b0000011000,
        0b0000011000,
        0b0000011000,
        0b0000111000,
        0b0001110000,
        0b0001100000,
        0b0000000000,
        0b0000000000,
    ]; // )
    r[0x2A] = [
        0b0000000000,
        0b0000000000,
        0b0000110000,
        0b0000110000,
        0b0011111100,
        0b0001111000,
        0b0001001000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
    ]; // *
    r[0x2B] = [
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0111111110,
        0b0111111110,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
    ]; // +
    r[0x2C] = [
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000110000,
        0b0000110000,
        0b0001110000,
        0b0001100000,
    ]; // ,
    r[0x2D] = [
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0001111000,
        0b0001111000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
    ]; // -
    r[0x2E] = [
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000110000,
        0b0000110000,
        0b0000000000,
        0b0000000000,
    ]; // .
    r[0x2F] = [
        0b0000000000,
        0b0000000000,
        0b0000000110,
        0b0000000110,
        0b0000001110,
        0b0000001100,
        0b0000011100,
        0b0000011000,
        0b0000111000,
        0b0000110000,
        0b0000110000,
        0b0001110000,
        0b0001100000,
        0b0011100000,
        0b0011000000,
        0b0111000000,
        0b0110000000,
        0b0110000000,
        0b0000000000,
        0b0000000000,
    ]; // /
    r[0x30] = [
        0b0000000000,
        0b0000000000,
        0b0011111100,
        0b0111111110,
        0b0110001110,
        0b0110001110,
        0b0110011110,
        0b0110011110,
        0b0110010110,
        0b0110110110,
        0b0110110110,
        0b0110100110,
        0b0111100110,
        0b0111100110,
        0b0111000110,
        0b0111000110,
        0b0111111110,
        0b0011111100,
        0b0000000000,
        0b0000000000,
    ]; // 0
    r[0x31] = [
        0b0000000000,
        0b0000000000,
        0b0000110000,
        0b0001110000,
        0b0011110000,
        0b0011110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0111111110,
        0b0111111110,
        0b0000000000,
        0b0000000000,
    ]; // 1
    r[0x32] = [
        0b0000000000,
        0b0000000000,
        0b0011111100,
        0b0111111110,
        0b0110000110,
        0b0000000110,
        0b0000000110,
        0b0000000110,
        0b0000000110,
        0b0000001110,
        0b0000011100,
        0b0000111000,
        0b0001110000,
        0b0011100000,
        0b0111000000,
        0b0110000000,
        0b0111111110,
        0b0111111110,
        0b0000000000,
        0b0000000000,
    ]; // 2
    r[0x33] = [
        0b0000000000,
        0b0000000000,
        0b0011111100,
        0b0111111110,
        0b0110000110,
        0b0000000110,
        0b0000000110,
        0b0000000110,
        0b0000000110,
        0b0001111100,
        0b0001111100,
        0b0000000110,
        0b0000000110,
        0b0000000110,
        0b0000000110,
        0b0110000110,
        0b0111111110,
        0b0011111100,
        0b0000000000,
        0b0000000000,
    ]; // 3
    r[0x34] = [
        0b0000000000,
        0b0000000000,
        0b0000011100,
        0b0000011100,
        0b0000111100,
        0b0000111100,
        0b0001111100,
        0b0001101100,
        0b0011101100,
        0b0011001100,
        0b0111001100,
        0b0111111110,
        0b0111111110,
        0b0000001100,
        0b0000001100,
        0b0000001100,
        0b0000001100,
        0b0000001100,
        0b0000000000,
        0b0000000000,
    ]; // 4
    r[0x35] = [
        0b0000000000,
        0b0000000000,
        0b0111111110,
        0b0111111110,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0111111100,
        0b0111111110,
        0b0000000110,
        0b0000000110,
        0b0000000110,
        0b0000000110,
        0b0110000110,
        0b0111111110,
        0b0011111100,
        0b0000000000,
        0b0000000000,
    ]; // 5
    r[0x36] = [
        0b0000000000,
        0b0000000000,
        0b0011111100,
        0b0111111110,
        0b0110000110,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0111111100,
        0b0111111110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0111111110,
        0b0011111100,
        0b0000000000,
        0b0000000000,
    ]; // 6
    r[0x37] = [
        0b0000000000,
        0b0000000000,
        0b0111111110,
        0b0111111110,
        0b0000000110,
        0b0000001110,
        0b0000001100,
        0b0000011100,
        0b0000011000,
        0b0000111000,
        0b0000110000,
        0b0001110000,
        0b0001100000,
        0b0011100000,
        0b0011000000,
        0b0111000000,
        0b0110000000,
        0b0110000000,
        0b0000000000,
        0b0000000000,
    ]; // 7
    r[0x38] = [
        0b0000000000,
        0b0000000000,
        0b0011111100,
        0b0111111110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0011111100,
        0b0011111100,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0111111110,
        0b0011111100,
        0b0000000000,
        0b0000000000,
    ]; // 8
    r[0x39] = [
        0b0000000000,
        0b0000000000,
        0b0011111100,
        0b0111111110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0111111110,
        0b0011111110,
        0b0000000110,
        0b0000000110,
        0b0000000110,
        0b0000000110,
        0b0000000110,
        0b0000000110,
        0b0000000110,
        0b0000000110,
        0b0000000000,
        0b0000000000,
    ]; // 9
    r[0x3A] = [
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000110000,
        0b0000110000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000110000,
        0b0000110000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
    ]; // :
    r[0x3B] = [
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000110000,
        0b0000110000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000110000,
        0b0000110000,
        0b0001110000,
        0b0001100000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
    ]; // ;
    r[0x3C] = [
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000001100,
        0b0000011100,
        0b0000111000,
        0b0001110000,
        0b0011100000,
        0b0011100000,
        0b0001110000,
        0b0000111000,
        0b0000011100,
        0b0000001100,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
    ]; // <
    r[0x3D] = [
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0011111100,
        0b0011111100,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0011111100,
        0b0011111100,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
    ]; // =
    r[0x3E] = [
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0011000000,
        0b0011100000,
        0b0001110000,
        0b0000111000,
        0b0000011100,
        0b0000011100,
        0b0000111000,
        0b0001110000,
        0b0011100000,
        0b0011000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
    ]; // >
    r[0x3F] = [
        0b0000000000,
        0b0000000000,
        0b0011111100,
        0b0111111110,
        0b0110000110,
        0b0000000110,
        0b0000000110,
        0b0000000110,
        0b0000111110,
        0b0000111100,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000000000,
        0b0000000000,
        0b0000110000,
        0b0000110000,
        0b0000000000,
        0b0000000000,
    ]; // ?
    r[0x40] = [
        0b0000000000,
        0b0000000000,
        0b0011111100,
        0b0110000110,
        0b0100000010,
        0b0100000010,
        0b0100000010,
        0b0100111010,
        0b0101101010,
        0b0101001010,
        0b0101001010,
        0b0101101010,
        0b0100111100,
        0b0100000000,
        0b0100000000,
        0b0100000010,
        0b0110000110,
        0b0011111100,
        0b0000000000,
        0b0000000000,
    ]; // @
    r[0x41] = [
        0b0000000000,
        0b0000000000,
        0b0011111100,
        0b0111111110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0111111110,
        0b0111111110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0000000000,
        0b0000000000,
    ]; // A
    r[0x42] = [
        0b0000000000,
        0b0000000000,
        0b0111111100,
        0b0111111110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0111111100,
        0b0111111100,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0111111110,
        0b0111111100,
        0b0000000000,
        0b0000000000,
    ]; // B
    r[0x43] = [
        0b0000000000,
        0b0000000000,
        0b0011111100,
        0b0111111110,
        0b0110000110,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0110000110,
        0b0111111110,
        0b0011111100,
        0b0000000000,
        0b0000000000,
    ]; // C
    r[0x44] = [
        0b0000000000,
        0b0000000000,
        0b0111111100,
        0b0111111110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0111111110,
        0b0111111100,
        0b0000000000,
        0b0000000000,
    ]; // D
    r[0x45] = [
        0b0000000000,
        0b0000000000,
        0b0111111110,
        0b0111111110,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0111111100,
        0b0111111100,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0111111110,
        0b0111111110,
        0b0000000000,
        0b0000000000,
    ]; // E
    r[0x46] = [
        0b0000000000,
        0b0000000000,
        0b0111111110,
        0b0111111110,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0111111100,
        0b0111111100,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0000000000,
        0b0000000000,
    ]; // F
    r[0x47] = [
        0b0000000000,
        0b0000000000,
        0b0011111100,
        0b0111111110,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0110011110,
        0b0110011110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0111111110,
        0b0011111100,
        0b0000000000,
        0b0000000000,
    ]; // G
    r[0x48] = [
        0b0000000000,
        0b0000000000,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0111111110,
        0b0111111110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0000000000,
        0b0000000000,
    ]; // H
    r[0x49] = [
        0b0000000000,
        0b0000000000,
        0b0111111110,
        0b0111111110,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0111111110,
        0b0111111110,
        0b0000000000,
        0b0000000000,
    ]; // I
    r[0x4A] = [
        0b0000000000,
        0b0000000000,
        0b0111111110,
        0b0111111110,
        0b0000000110,
        0b0000000110,
        0b0000000110,
        0b0000000110,
        0b0000000110,
        0b0000000110,
        0b0000000110,
        0b0000000110,
        0b0000000110,
        0b0000000110,
        0b0000000110,
        0b0110000110,
        0b0111111110,
        0b0011111100,
        0b0000000000,
        0b0000000000,
    ]; // J
    r[0x4B] = [
        0b0000000000,
        0b0000000000,
        0b0110000110,
        0b0110001110,
        0b0110011100,
        0b0110111000,
        0b0111110000,
        0b0111100000,
        0b0111000000,
        0b0110000000,
        0b0110000000,
        0b0111000000,
        0b0111100000,
        0b0111110000,
        0b0110111000,
        0b0110011100,
        0b0110001110,
        0b0110000110,
        0b0000000000,
        0b0000000000,
    ]; // K
    r[0x4C] = [
        0b0000000000,
        0b0000000000,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0111111110,
        0b0111111110,
        0b0000000000,
        0b0000000000,
    ]; // L
    r[0x4D] = [
        0b0000000000,
        0b0000000000,
        0b0110000110,
        0b0110000110,
        0b0111001110,
        0b0111001110,
        0b0111111110,
        0b0110110110,
        0b0110110110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0000000000,
        0b0000000000,
    ]; // M
    r[0x4E] = [
        0b0000000000,
        0b0000000000,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0111000110,
        0b0111000110,
        0b0111100110,
        0b0111100110,
        0b0110110110,
        0b0110110110,
        0b0110011110,
        0b0110011110,
        0b0110001110,
        0b0110001110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0000000000,
        0b0000000000,
    ]; // N
    r[0x4F] = [
        0b0000000000,
        0b0000000000,
        0b0011111100,
        0b0111111110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0111111110,
        0b0011111100,
        0b0000000000,
        0b0000000000,
    ]; // O
    r[0x50] = [
        0b0000000000,
        0b0000000000,
        0b0111111100,
        0b0111111110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0111111110,
        0b0111111100,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0000000000,
        0b0000000000,
    ]; // P
    r[0x51] = [
        0b0000000000,
        0b0000000000,
        0b0011111100,
        0b0111111110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110011110,
        0b0110011100,
        0b0111111110,
        0b0011110110,
        0b0000000000,
        0b0000000000,
    ]; // Q
    r[0x52] = [
        0b0000000000,
        0b0000000000,
        0b0111111100,
        0b0111111110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0111111100,
        0b0111111100,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0000000000,
        0b0000000000,
    ]; // R
    r[0x53] = [
        0b0000000000,
        0b0000000000,
        0b0011111100,
        0b0111111110,
        0b0110000110,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0111111100,
        0b0011111110,
        0b0000000110,
        0b0000000110,
        0b0000000110,
        0b0000000110,
        0b0110000110,
        0b0111111110,
        0b0011111100,
        0b0000000000,
        0b0000000000,
    ]; // S
    r[0x54] = [
        0b0000000000,
        0b0000000000,
        0b0111111110,
        0b0111111110,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000000000,
        0b0000000000,
    ]; // T
    r[0x55] = [
        0b0000000000,
        0b0000000000,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0111111110,
        0b0011111100,
        0b0000000000,
        0b0000000000,
    ]; // U
    r[0x56] = [
        0b0000000000,
        0b0000000000,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0111001110,
        0b0011001100,
        0b0011001100,
        0b0011111100,
        0b0001111000,
        0b0001111000,
        0b0001111000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000000000,
        0b0000000000,
    ]; // V
    r[0x57] = [
        0b0000000000,
        0b0000000000,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110110110,
        0b0110110110,
        0b0111111110,
        0b0011001100,
        0b0000000000,
        0b0000000000,
    ]; // W
    r[0x58] = [
        0b0000000000,
        0b0000000000,
        0b0110000110,
        0b0110000110,
        0b0111001110,
        0b0011001100,
        0b0011111100,
        0b0001111000,
        0b0001111000,
        0b0000110000,
        0b0000110000,
        0b0001111000,
        0b0001111000,
        0b0011111100,
        0b0011001100,
        0b0111001110,
        0b0110000110,
        0b0110000110,
        0b0000000000,
        0b0000000000,
    ]; // X
    r[0x59] = [
        0b0000000000,
        0b0000000000,
        0b0110000110,
        0b0110000110,
        0b0111001110,
        0b0011001100,
        0b0011111100,
        0b0001111000,
        0b0001111000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000000000,
        0b0000000000,
    ]; // Y
    r[0x5A] = [
        0b0000000000,
        0b0000000000,
        0b0111111110,
        0b0111111110,
        0b0000000110,
        0b0000001110,
        0b0000001100,
        0b0000011100,
        0b0000011000,
        0b0000111000,
        0b0000110000,
        0b0001110000,
        0b0001100000,
        0b0011100000,
        0b0011000000,
        0b0111000000,
        0b0111111110,
        0b0111111110,
        0b0000000000,
        0b0000000000,
    ]; // Z
    r[0x5B] = [
        0b0000000000,
        0b0000000000,
        0b0001111000,
        0b0001111000,
        0b0001100000,
        0b0001100000,
        0b0001100000,
        0b0001100000,
        0b0001100000,
        0b0001100000,
        0b0001100000,
        0b0001100000,
        0b0001100000,
        0b0001100000,
        0b0001100000,
        0b0001100000,
        0b0001111000,
        0b0001111000,
        0b0000000000,
        0b0000000000,
    ]; // [
    r[0x5C] = [
        0b0000000000,
        0b0000000000,
        0b0110000000,
        0b0110000000,
        0b0111000000,
        0b0011000000,
        0b0011100000,
        0b0001100000,
        0b0001110000,
        0b0000110000,
        0b0000110000,
        0b0000111000,
        0b0000011000,
        0b0000011100,
        0b0000001100,
        0b0000001110,
        0b0000000110,
        0b0000000110,
        0b0000000000,
        0b0000000000,
    ]; // \
    r[0x5D] = [
        0b0000000000,
        0b0000000000,
        0b0001111000,
        0b0001111000,
        0b0000011000,
        0b0000011000,
        0b0000011000,
        0b0000011000,
        0b0000011000,
        0b0000011000,
        0b0000011000,
        0b0000011000,
        0b0000011000,
        0b0000011000,
        0b0000011000,
        0b0000011000,
        0b0001111000,
        0b0001111000,
        0b0000000000,
        0b0000000000,
    ]; // ]
    r[0x5E] = [
        0b0000000000,
        0b0000000000,
        0b0000110000,
        0b0001111000,
        0b0011111100,
        0b0111001110,
        0b0110000110,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
    ]; // ^
    r[0x5F] = [
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0111111110,
        0b0111111110,
        0b0000000000,
    ]; // _
    r[0x60] = [
        0b0000000000,
        0b0000100000,
        0b0000010000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
    ]; // `
    r[0x61] = [
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0011111100,
        0b0111111110,
        0b0000000110,
        0b0011111110,
        0b0111111110,
        0b0110000110,
        0b0111111110,
        0b0011111110,
        0b0000000000,
        0b0000000000,
    ]; // a
    r[0x62] = [
        0b0000000000,
        0b0000000000,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0111111100,
        0b0111111110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0111111110,
        0b0111111100,
        0b0000000000,
        0b0000000000,
    ]; // b
    r[0x63] = [
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0011111100,
        0b0111111110,
        0b0110000110,
        0b0110000000,
        0b0110000000,
        0b0110000110,
        0b0111111110,
        0b0011111100,
        0b0000000000,
        0b0000000000,
    ]; // c
    r[0x64] = [
        0b0000000000,
        0b0000000000,
        0b0000000110,
        0b0000000110,
        0b0000000110,
        0b0000000110,
        0b0000000110,
        0b0000000110,
        0b0000000110,
        0b0000000110,
        0b0011111110,
        0b0111111110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0111111110,
        0b0011111110,
        0b0000000000,
        0b0000000000,
    ]; // d
    r[0x65] = [
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0011111100,
        0b0111111110,
        0b0110000110,
        0b0111111110,
        0b0111111110,
        0b0110000000,
        0b0111111110,
        0b0011111110,
        0b0000000000,
        0b0000000000,
    ]; // e
    r[0x66] = [
        0b0000000000,
        0b0000000000,
        0b0000011110,
        0b0000111110,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0111111110,
        0b0111111110,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000000000,
        0b0000000000,
    ]; // f
    r[0x67] = [
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0011111110,
        0b0111111110,
        0b0110000110,
        0b0111111110,
        0b0011111100,
        0b0110000000,
        0b0011111100,
        0b0111111110,
        0b0110000110,
        0b0111111110,
        0b0011111100,
    ]; // g
    r[0x68] = [
        0b0000000000,
        0b0000000000,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0111111100,
        0b0111111110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0000000000,
        0b0000000000,
    ]; // h
    r[0x69] = [
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000110000,
        0b0000110000,
        0b0000000000,
        0b0000000000,
        0b0011110000,
        0b0011110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0011111100,
        0b0011111100,
        0b0000000000,
        0b0000000000,
    ]; // i
    r[0x6A] = [
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000001100,
        0b0000001100,
        0b0000000000,
        0b0000000000,
        0b0011111100,
        0b0011111100,
        0b0000001100,
        0b0000001100,
        0b0000001100,
        0b0000001100,
        0b0000001100,
        0b0011001100,
        0b0011111100,
        0b0001111000,
    ]; // j
    r[0x6B] = [
        0b0000000000,
        0b0000000000,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0110000110,
        0b0110001110,
        0b0110011100,
        0b0110111000,
        0b0111110000,
        0b0111100000,
        0b0111100000,
        0b0111110000,
        0b0110111000,
        0b0110011100,
        0b0110001110,
        0b0110000110,
        0b0000000000,
        0b0000000000,
    ]; // k
    r[0x6C] = [
        0b0000000000,
        0b0000000000,
        0b0011110000,
        0b0011110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0011111100,
        0b0011111100,
        0b0000000000,
        0b0000000000,
    ]; // l
    r[0x6D] = [
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0111111100,
        0b0111111110,
        0b0110110110,
        0b0110110110,
        0b0110110110,
        0b0110110110,
        0b0110110110,
        0b0110110110,
        0b0000000000,
        0b0000000000,
    ]; // m
    r[0x6E] = [
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0111111100,
        0b0111111110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0000000000,
        0b0000000000,
    ]; // n
    r[0x6F] = [
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0011111100,
        0b0111111110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0111111110,
        0b0011111100,
        0b0000000000,
        0b0000000000,
    ]; // o
    r[0x70] = [
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0111111100,
        0b0111111110,
        0b0110000110,
        0b0110000110,
        0b0111111110,
        0b0111111100,
        0b0110000000,
        0b0110000000,
        0b0110000000,
        0b0110000000,
    ]; // p
    r[0x71] = [
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0011111110,
        0b0111111110,
        0b0110000110,
        0b0110000110,
        0b0111111110,
        0b0011111110,
        0b0000000110,
        0b0000000110,
        0b0000000110,
        0b0000000110,
    ]; // q
    r[0x72] = [
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0011111000,
        0b0011111100,
        0b0011001100,
        0b0011000000,
        0b0011000000,
        0b0011000000,
        0b0011000000,
        0b0011000000,
        0b0000000000,
        0b0000000000,
    ]; // r
    r[0x73] = [
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0011111110,
        0b0111111110,
        0b0110000000,
        0b0111111100,
        0b0011111110,
        0b0000000110,
        0b0111111110,
        0b0111111100,
        0b0000000000,
        0b0000000000,
    ]; // s
    r[0x74] = [
        0b0000000000,
        0b0000000000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0111111110,
        0b0111111110,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000111110,
        0b0000011110,
        0b0000000000,
        0b0000000000,
    ]; // t
    r[0x75] = [
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0110000110,
        0b0111111110,
        0b0011111110,
        0b0000000000,
        0b0000000000,
    ]; // u
    r[0x76] = [
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0110000110,
        0b0110000110,
        0b0111001110,
        0b0011001100,
        0b0011111100,
        0b0001111000,
        0b0001111000,
        0b0000110000,
        0b0000000000,
        0b0000000000,
    ]; // v
    r[0x77] = [
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0110110110,
        0b0110110110,
        0b0110110110,
        0b0110110110,
        0b0110110110,
        0b0110110110,
        0b0111111110,
        0b0011111100,
        0b0000000000,
        0b0000000000,
    ]; // w
    r[0x78] = [
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0110000110,
        0b0111001110,
        0b0011111100,
        0b0001111000,
        0b0001111000,
        0b0011111100,
        0b0111001110,
        0b0110000110,
        0b0000000000,
        0b0000000000,
    ]; // x
    r[0x79] = [
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0110000110,
        0b0110000110,
        0b0111111110,
        0b0011111110,
        0b0000000110,
        0b0000000110,
        0b0000000110,
        0b0110000110,
        0b0111111110,
        0b0011111100,
    ]; // y
    r[0x7A] = [
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0111111110,
        0b0111111110,
        0b0000001110,
        0b0001111100,
        0b0011111000,
        0b0111000000,
        0b0111111110,
        0b0111111110,
        0b0000000000,
        0b0000000000,
    ]; // z
    r[0x7B] = [
        0b0000000000,
        0b0000000000,
        0b0000111000,
        0b0001111000,
        0b0001100000,
        0b0001100000,
        0b0001100000,
        0b0001100000,
        0b0001100000,
        0b0011000000,
        0b0011000000,
        0b0001100000,
        0b0001100000,
        0b0001100000,
        0b0001100000,
        0b0001100000,
        0b0001111000,
        0b0000111000,
        0b0000000000,
        0b0000000000,
    ]; // {
    r[0x7C] = [
        0b0000000000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000110000,
        0b0000000000,
    ]; // ]
    r[0x7D] = [
        0b0000000000,
        0b0000000000,
        0b0001110000,
        0b0001111000,
        0b0000011000,
        0b0000011000,
        0b0000011000,
        0b0000011000,
        0b0000011000,
        0b0000001100,
        0b0000001100,
        0b0000011000,
        0b0000011000,
        0b0000011000,
        0b0000011000,
        0b0000011000,
        0b0001111000,
        0b0001110000,
        0b0000000000,
        0b0000000000,
    ]; // ]
    r[0x7E] = [
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0011100000,
        0b0111110110,
        0b0110111110,
        0b0000011100,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
        0b0000000000,
    ]; // ]
    r
};

fn set_ascii(c: u8, px: u32, py: u32) {
    let d = CONSOLE_ASCII[c as usize];
    for y in 0..20 {
        for x in 0..10 {
            let b = (d[y] >> (9 - x)) & 1 != 0;
            if b {
                set_pixel(px * 10 + x, py * 20 + y as u32, 0xFF, 0xFF, 0xFF).unwrap();
            } else {
                set_pixel(px * 10 + x, py * 20 + y as u32, 0, 0, 0).unwrap();
            }
        }
    }
}

pub struct KissConsole {
    px: u32,
    py: u32,
}
impl KissConsole {
    pub const fn new() -> Self {
        Self { px: 0, py: 0 }
    }

    fn print_ascii(&mut self, v: u8) {
        match v {
            b'\n' => self.py += 1,
            b'\r' => self.px = 0,
            _ => {
                set_ascii(v, self.px, self.py);
                self.px += 1;
            }
        }
    }
    fn print_ascii_str(&mut self, s: &str) {
        for &b in s.as_bytes() {
            self.print_ascii(b);
        }
    }

    fn print_utf16(&mut self, v: u16) {
        // for now
        self.print_ascii(v as u8);
        self.px += 1;
    }
    fn print_utf16_str(&mut self, s: &str) {
        for c in s.encode_utf16() {}
    }
}
impl Write for KissConsole {
    fn write_str(&mut self, s: &str) -> core::fmt::Result {
        if s.is_ascii() {
            self.print_ascii_str(s);
        } else {
            self.print_utf16_str(s);
        }

        Ok(())
    }
}
